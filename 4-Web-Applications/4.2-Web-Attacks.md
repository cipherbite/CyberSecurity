 # Introduction to Web Attacks

This repository is dedicated to providing a comprehensive understanding of various types of web attacks. In today's internet era, web attacks pose a significant threat, with attackers exploiting vulnerabilities in web applications to gain unauthorized access, steal sensitive data, or disrupt services.

## Contents

1. [SSRF Basic Filter Bypasses](#ssrf-basic-filter-bypasses)
2. [DNS Rebinding: SSRF Filter Bypass](#dns-rebinding-ssrf-filter-bypass)
3. [DNSbinding: Same-Origin Policy Bypass](#dns-rebinding-same-origin-policy-bypass)
4. [DNS Rebinding: Tools & Prevention](#dns-rebinding-tools--prevention)
5. [More to come...]

# SSRF with Filter Bypass via Open Redirection

Server-Side Request Forgery (SSRF) poses a significant threat to web security. Understanding the basics of basic filter bypass techniques is crucial for effective penetration testing.

## Example Command

```bash
curl -i http://vulnerable-server.local/request?url=http://internal-server.local/
```

![Redirect Example 1](https://i.postimg.cc/2y6jR0LB/redirectnb2.png)
![Redirect Example 2](https://i.postimg.cc/j5qtPMXk/redirect3.png)

## Exploiting the Vulnerability

- Modifying the `stockApi` parameter directly is prevented.
- **Crafting the Exploit URL:**
  - Creating a crafted URL to exploit the redirection, such as redirecting to the admin interface:
    ```plaintext
    /product/nextProduct?path=http://192.168.0.12:8080/admin
    ```
- **Using the Exploit URL:**
  - Utilizing this URL in the `stockApi` parameter:
    ```bash
    curl -i "http://vulnerable-server.local/product/nextProduct?path=http://192.168.0.12:8080/admin"
    ```
- **Exploiting the Vulnerability:**
  - The stock checker follows the redirection and displays the admin page, enabling actions like user deletion.

These steps illustrate how an open redirection vulnerability can be exploited to bypass SSRF filters and execute unauthorized actions on internal systems.

## DNS Rebinding: SSRF Filter Bypass

DNS Rebinding enhances SSRF attacks by circumventing DNS-result-checked filters at request time. This section provides practical commands to illustrate this tactic.

### Commands:
- **Essence of DNS Rebinding Bypass:**
  - Exploits server-side request forgery (SSRF) protection via DNS rebinding.
  - Application checks user input against blacklisted IPs and resolves domains to IPs for verification.
  - Attacker configures DNS with short Time To Live (TTL), causing periodic IP changes to evade blacklist checks.
  - User repeatedly triggers requests, awaiting TTL expiration to refresh DNS resolution with a non-blacklisted IP.
  - Application continues processing, fetching content from initially blacklisted IPs after successful bypass.

## DNS Rebinding: Same-Origin Policy Bypass

The Same-Origin Policy is a crucial browser security protocol. DNS Rebinding attacks can bypass this policy to exploit vulnerabilities.

### Test Command:
- DNS rebinding attacks exploit browser vulnerabilities to access internal network resources, bypassing security measures.
- Mitigation strategies include browser-based, DNS-based, server-based, and real-time detection methods.

## DNS Rebinding: Tools & Prevention

Understanding both offensive and defensive tools is crucial in mitigating DNS Rebinding threats. The following tools and commands are recommended.

### Tool Example:
- Using `nslookup` to explore and pinpoint potential harmful DNS configurations susceptible to Rebinding attacks.
  ![DNS Tool Command Screenshot](assets/images/dns_tool_command.png)
- Utilizing Nmapâ€™s DNS rebinding script to detect vulnerabilities on the target site.
  ![DNS Rebinding Nmap Scan Screenshot](assets/images/dns_rebinding_nmap_scan.png)

### Advanced DNS Tunneling Command:
- Setting up a DNS tunnel using `iodine`, enabling data encapsulation within DNS queries and responses for stealthy data exfiltration.
  ![Advanced DNS Tunneling Screenshot](assets/images/advanced_dns_tunneling.png)

## License

This project is under the MIT License. For more details, please refer to the [LICENSE.md](LICENSE.md) file.

This README provides a comprehensive and accessible guide, serving as an invaluable resource for both novices and seasoned pentesters looking to deepen their understanding of sophisticated network security challenges.    
